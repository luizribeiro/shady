WHITESPACE = _{ " " | "\t" | "\r" | "\n" }

program = { SOI ~ (expr ~ ";")* ~ EOI }

expr = {
  prefix* ~ primary ~ postfix*
  ~ (infix ~ prefix* ~ primary ~ postfix* )*
}

infix =  _{ add | sub | mul | div | pow }
add = { "+" }
sub = { "-" }
mul = { "*" }
div = { "/" }
pow = { "^" }

prefix = _{ neg }
neg = { "-" }

postfix = _{ fac }
fac = { "!" }

primary = _{ value | "(" ~ expr ~ ")" }

value = _{ int }
int = @{ ASCII_NONZERO_DIGIT ~ ASCII_DIGIT+ | ASCII_DIGIT }
